# PRD

## 1. 제품 개요

Gemini API를 활용한 AI 기반 구독제 사주풀이 서비스. 사용자의 생년월일과 출생시간을 바탕으로 천간지지, 오행분석, 대운/세운 해석을 통한 개인 맞춤형 사주 분석을 제공하는 웹 애플리케이션.

**핵심 목표**:
- (1) **AI 기반 정확한 사주 분석**: Gemini API를 통한 전문적 사주 해석
- (2) **유연한 구독 시스템**: 무료 체험부터 Pro 구독까지 단계별 서비스 제공
- (3) **안정적인 결제 처리**: 토스페이먼츠를 통한 정기결제 자동화
- (4) **사용자 친화적 인증**: Clerk를 통한 간편한 Google OAuth 로그인

## 2. Stakeholders

### 주요 사용자
- **무료 회원 (Free User)**:
  - 회원가입 시 3회 무료 체험 제공
  - 기본적인 사주 분석 기능 이용 (gemini-2.0-flash 모델)
  - 체험 횟수 소진 후 Pro 구독 전환 유도

- **Pro 회원 (Pro Subscriber)**:
  - 월 10회 프리미엄 분석 제공
  - 고급 AI 모델 사용 (gemini-2.0-pro)
  - 월 정기결제를 통한 지속적 서비스 이용
  - 구독 취소/재활성화 자유롭게 가능

### 시스템 운영자
- **서비스 관리자**:
  - 결제 처리 및 구독 상태 관리
  - 사용자 데이터 및 분석 이력 관리
  - 시스템 모니터링 및 유지보수

## 3. 포함 페이지

### 3.1 홈 (랜딩페이지)
- **접근 권한**: 비로그인 사용자 포함 모두 접근 가능
- **주요 기능**:
  - 서비스 소개 및 주요 특징 설명
  - 무료 체험 및 Pro 구독 혜택 안내
  - 로그인/회원가입 CTA
  - 샘플 분석 결과 미리보기

### 3.2 대시보드
- **접근 권한**: 로그인 필수
- **주요 기능**:
  - 사용자의 모든 분석 이력 목록 표시
  - 남은 분석 횟수 표시 (무료: X/3회, Pro: X/10회)
  - 최근 분석 결과 요약 카드
  - 새 분석하기 바로가기
  - 구독 상태 표시

### 3.3 새 분석하기
- **접근 권한**: 로그인 필수
- **주요 기능**:
  - 분석 정보 입력 폼
    - 성함 (필수)
    - 생년월일 (필수)
    - 출생시간 (선택, 시/분 단위)
    - 성별 (필수, 남/여 선택)
  - 분석 실행 버튼
  - 남은 분석 횟수 확인
  - 분석 처리 중 로딩 상태 표시

### 3.4 분석 상세보기
- **접근 권한**: 로그인 필수 (본인의 분석 결과만 열람 가능)
- **주요 기능**:
  - 천간지지 계산 결과
  - 오행(목, 화, 토, 금, 수) 분포도 및 해석
  - 대운/세운 흐름도
  - 종합 분석 결과:
    - 성격 분석
    - 재운 분석
    - 건강운 분석
    - 연애운 분석
  - 분석 결과 다운로드/공유 기능
  - 재분석 요청 버튼

### 3.5 구독 관리
- **접근 권한**: 로그인 필수
- **주요 기능**:
  - 현재 구독 상태 표시 (무료/Pro/해지예정)
  - Pro 구독 신청/해지
  - 결제 정보 관리 (카드 등록/변경)
  - 결제 내역 확인
  - 다음 결제일 표시
  - 구독 재활성화 (해지 후 결제일 전까지)

## 4. 사용자 여정 (User Journey)

### 4.1 신규 사용자 여정
1. **랜딩페이지 방문** → 서비스 소개 확인
2. **회원가입** → Google OAuth로 간편 가입 (Clerk)
3. **첫 분석 시작** → 대시보드에서 "새 분석하기" 클릭
4. **정보 입력** → 성함, 생년월일, 출생시간(선택), 성별 입력
5. **분석 실행** → AI 처리 중 대기 (gemini-2.0-flash)
6. **결과 확인** → 상세한 사주 분석 결과 열람
7. **추가 분석** → 남은 무료 횟수(2회) 내에서 추가 분석
8. **Pro 전환 유도** → 무료 횟수 소진 시 구독 안내

### 4.2 Pro 구독자 여정
1. **구독 신청** → 구독 관리 페이지에서 Pro 플랜 선택
2. **결제 정보 입력** → 토스페이먼츠 결제창에서 카드 정보 입력
3. **빌링키 저장** → 정기결제를 위한 결제 정보 저장
4. **프리미엄 분석** → gemini-2.0-pro 모델로 더 정확한 분석
5. **월 10회 이용** → 매월 초기화되는 분석 횟수
6. **자동 결제** → 매월 결제일에 자동 갱신
7. **구독 관리** → 필요시 구독 해지/재활성화

### 4.3 구독 해지 및 재활성화 여정
1. **구독 해지 요청** → 구독 관리에서 "구독 해지" 선택
2. **해지 확인** → 다음 결제일까지 혜택 유지 안내
3. **빌링키 삭제** → 해지 처리 시 결제 정보 삭제
4. **혜택 유지** → 결제일까지 Pro 기능 계속 이용
5. **재활성화 (옵션)** → 결제일 전 구독 재활성화 가능
6. **무료 전환** → 결제일 이후 자동으로 무료 회원 전환

## 5. IA (Information Architecture)

```
/ (홈/랜딩페이지)
├─ /auth
│  ├─ /signin (로그인)
│  └─ /signup (회원가입)
├─ /dashboard (대시보드)
│  ├─ /analyses (분석 목록)
│  └─ /stats (통계)
├─ /analysis
│  ├─ /new (새 분석하기)
│  └─ /[id] (분석 상세보기)
│     ├─ /overview (개요)
│     ├─ /elements (오행분석)
│     ├─ /fortune (운세흐름)
│     └─ /interpretation (종합해석)
├─ /subscription (구독 관리)
│  ├─ /plans (플랜 선택)
│  ├─ /billing (결제 정보)
│  └─ /history (결제 내역)
└─ /profile (프로필)
   ├─ /settings (설정)
   └─ /account (계정 관리)
```

## 6. 비즈니스 룰 및 정책

### 6.1 분석 횟수 정책
- **무료 회원**: 가입 시 3회 제공, 소진 후 추가 불가
- **Pro 회원**: 월 10회, 매월 1일 초기화
- **미사용 횟수**: 다음 달로 이월 불가

### 6.2 구독 결제 정책
- **결제 주기**: 매월 동일 날짜 자동 결제
- **결제 실패**: 3회 재시도 후 자동 해지
- **환불 정책**: 7일 이내 전액 환불 (미사용 시)
- **빌링키 관리**: 해지 시 즉시 삭제

### 6.3 데이터 보관 정책
- **분석 결과**: 영구 보관 (사용자 삭제 전까지)
- **개인정보**: 회원 탈퇴 시 즉시 삭제
- **결제 정보**: 토스페이먼츠에서 별도 관리

### 6.4 AI 모델 사용 정책
- **무료 회원**: gemini-2.0-flash (빠른 응답, 기본 정확도)
- **Pro 회원**: gemini-2.0-pro (높은 정확도, 상세 분석)
- **Rate Limiting**: 분당 최대 5회 요청 제한

## 7. 기술 스택

- **Frontend**: Next.js, React, TypeScript, Tailwind CSS
- **Backend**: Supabase (Database, Auth 연동)
- **인증**: Clerk (Google OAuth)
- **결제**: 토스페이먼츠 (정기결제)
- **AI**: Google Gemini API
- **배포**: Vercel

## 8. 성공 지표 (KPIs)

- **사용자 지표**:
  - MAU (Monthly Active Users)
  - 회원가입 전환율
  - Pro 구독 전환율

- **비즈니스 지표**:
  - MRR (Monthly Recurring Revenue)
  - Churn Rate (이탈률)
  - LTV (Life Time Value)

- **서비스 품질 지표**:
  - 평균 분석 응답 시간
  - 분석 정확도 만족도
  - 고객 만족도 (NPS)