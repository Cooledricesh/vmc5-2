<!DOCTYPE html>
<html>
<head>
  <title>Cookie Extractor for Playwright</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
    }
    .instruction {
      background: #f0f0f0;
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 20px;
    }
    textarea {
      width: 100%;
      height: 300px;
      font-family: monospace;
      padding: 10px;
    }
    button {
      background: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 5px;
    }
    button:hover {
      background: #45a049;
    }
    .success {
      background: #d4edda;
      color: #155724;
      padding: 15px;
      border-radius: 5px;
      margin-top: 20px;
      display: none;
    }
  </style>
</head>
<body>
  <h1>ğŸª Playwright ì¸ì¦ ìƒíƒœ ì¶”ì¶œê¸°</h1>

  <div class="instruction">
    <h3>ì‚¬ìš© ë°©ë²•:</h3>
    <ol>
      <li><strong>https://vmc5-2.vercel.app</strong>ì— ë¡œê·¸ì¸í•˜ì„¸ìš”</li>
      <li>ì´ HTML íŒŒì¼ì„ ë¸Œë¼ìš°ì €ì—ì„œ ì—½ë‹ˆë‹¤</li>
      <li>"ì¿ í‚¤ ì¶”ì¶œ" ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤</li>
      <li>"ë³µì‚¬" ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤</li>
      <li>ë³µì‚¬í•œ ë‚´ìš©ì„ <code>tests-e2e/.auth/user.json</code>ì— ë¶™ì—¬ë„£ìŠµë‹ˆë‹¤</li>
    </ol>
  </div>

  <button onclick="extractCookies()">ğŸª ì¿ í‚¤ ì¶”ì¶œ</button>
  <button onclick="copyToClipboard()">ğŸ“‹ ë³µì‚¬</button>
  <button onclick="downloadJSON()">ğŸ’¾ ë‹¤ìš´ë¡œë“œ</button>

  <div class="success" id="success">
    âœ… í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!
  </div>

  <h3>ì¶”ì¶œëœ JSON:</h3>
  <textarea id="output" readonly placeholder="'ì¿ í‚¤ ì¶”ì¶œ' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”..."></textarea>

  <script>
    let jsonData = '';

    function extractCookies() {
      // ëª¨ë“  ì¿ í‚¤ ê°€ì ¸ì˜¤ê¸°
      const cookies = document.cookie.split(';').map(cookie => {
        const [name, ...valueParts] = cookie.trim().split('=');
        const value = valueParts.join('=');

        return {
          name: name,
          value: value,
          domain: window.location.hostname,
          path: '/',
          expires: -1,
          httpOnly: false,
          secure: window.location.protocol === 'https:',
          sameSite: 'Lax'
        };
      }).filter(c => c.name && c.value);

      // Playwright storage state í˜•ì‹
      const storageState = {
        cookies: cookies,
        origins: [
          {
            origin: window.location.origin,
            localStorage: []
          }
        ]
      };

      jsonData = JSON.stringify(storageState, null, 2);
      document.getElementById('output').value = jsonData;

      console.log('ì¿ í‚¤ ì¶”ì¶œ ì™„ë£Œ:', storageState);
      alert(`${cookies.length}ê°œì˜ ì¿ í‚¤ë¥¼ ì¶”ì¶œí–ˆìŠµë‹ˆë‹¤!`);
    }

    function copyToClipboard() {
      const output = document.getElementById('output');
      if (!output.value) {
        alert('ë¨¼ì € "ì¿ í‚¤ ì¶”ì¶œ" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”!');
        return;
      }

      output.select();
      document.execCommand('copy');

      const success = document.getElementById('success');
      success.style.display = 'block';
      setTimeout(() => {
        success.style.display = 'none';
      }, 3000);
    }

    function downloadJSON() {
      if (!jsonData) {
        alert('ë¨¼ì € "ì¿ í‚¤ ì¶”ì¶œ" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”!');
        return;
      }

      const blob = new Blob([jsonData], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'user.json';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);

      alert('user.json íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\ntests-e2e/.auth/ í´ë”ë¡œ ì´ë™í•˜ì„¸ìš”.');
    }
  </script>
</body>
</html>
